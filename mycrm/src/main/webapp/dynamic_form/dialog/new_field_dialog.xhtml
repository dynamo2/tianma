<?xml version="1.0" encoding="UTF-8"?>
<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"
             xmlns:f="http://java.sun.com/jsf/core"
             xmlns:c="http://java.sun.com/jsp/jstl/core"
             xmlns:ace="http://www.icefaces.org/icefaces/components"
             xmlns:ui="http://java.sun.com/jsf/facelets">

    <ace:dialog id="newFieldDialog" header="#{i18n.formAddNewField}"
                widgetVar="newFieldDialog" closable="true" modal="true"
                draggable="true" showEffect="clip" hideEffect="fade"
                resizable="true">

        <h:panelGrid columns="3">
            <h:outputLabel value="#{i18n.form_fieldName}" for="newFieldName" />
            <h:inputText id="newFieldName"
                         value="#{formMetadataMgmtBean.newField.fieldName}">
                <f:validateRegex pattern="[a-zA-Z_0-9]*" />
                <f:validateRequired />
            </h:inputText>
            <h:message for="newFieldName" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldLabel}" for="newFieldLabel" />
            <h:inputText id="newFieldLabel"
                         value="#{formMetadataMgmtBean.newField.fieldLabel}">
                <f:validateRequired />
            </h:inputText>
            <h:message for="newFieldLabel" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldType}" for="newFieldType" />
            <h:selectOneMenu id="newFieldType" value="#{formMetadataMgmtBean.newField.fieldType}">
                <f:selectItems value="#{dynamicFormSelectionItems.fieldType}" />
            </h:selectOneMenu>
            <h:message for="newFieldType" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldDisplayPositionRow}"
                           for="displayPositionRow" />
            <h:inputText id="displayPositionRow"
                         value="#{formMetadataMgmtBean.newField.displayPositionRow}">
                <f:validateLongRange minimum="0" />
            </h:inputText>
            <h:message for="displayPositionRow" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldDisplayPositionColumn}"
                           for="displayPositionColumn" />
            <h:inputText id="displayPositionColumn"
                         value="#{formMetadataMgmtBean.newField.displayPositionColumn}">
                <f:validateLongRange minimum="0" />
            </h:inputText>
            <h:message for="displayPositionColumn" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldDisplayPositionGroup}"
                           for="displayPositionGroup" />
            <h:inputText id="displayPositionGroup"
                         value="#{formMetadataMgmtBean.newField.displayPositionGroup}">
                <f:validateLongRange minimum="0" />
            </h:inputText>
            <h:message for="displayPositionGroup" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldInputRows}"
                           for="formFieldInputRows" />
            <h:inputText id="formFieldInputRows"
                         value="#{formMetadataMgmtBean.newField.inputRows}">
                <f:validateLongRange minimum="0" />
            </h:inputText>
            <h:message for="formFieldInputRows" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldInputColumns}"
                           for="formFieldInputColumns" />
            <h:inputText id="formFieldInputColumns"
                         value="#{formMetadataMgmtBean.newField.inputColumns}">
                <f:validateLongRange minimum="0" />
            </h:inputText>
            <h:message for="formFieldInputColumns" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldIsLabel}" for="formFieldIsLabel" />
            <h:selectOneMenu id="formFieldIsLabel"
                             value="#{formMetadataMgmtBean.newField.isLabel}">
                <f:selectItems value="#{dynamicFormSelectionItems.trueOrFalse}"/>
            </h:selectOneMenu>
            <h:message for="formFieldIsLabel" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldIsRequired}"
                           for="formFieldIsRequired" />
            <h:selectOneMenu id="formFieldIsRequired"
                             value="#{formMetadataMgmtBean.newField.isRequired}">
                <f:selectItems value="#{dynamicFormSelectionItems.trueOrFalse}"/>
            </h:selectOneMenu>
            <h:message for="formFieldIsRequired" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldIsPrintable}"
                           for="formFieldIsPrintable" />
            <h:selectOneMenu id="formFieldIsPrintable"
                             value="#{formMetadataMgmtBean.newField.isPrintable}">
                <f:selectItems value="#{dynamicFormSelectionItems.trueOrFalse}"/>
            </h:selectOneMenu>
            <h:message for="formFieldIsRequired" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldExpression}"
                           for="formFieldExpression" />
            <h:inputText id="formFieldExpression"
                         value="#{formMetadataMgmtBean.newField.expression}" validator="#{formMetadataMgmtBean.validateExpression}" size="100"/>
            <h:message for="formFieldExpression" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldReferTo}"
                           for="formFieldReferTo" />
            <h:selectOneMenu id="formFieldReferTo" value="#{formMetadataMgmtBean.newField.referToFormMetadataId}">
                <f:selectItem itemLabel="#{i18n.pleaseSelectOne}" itemValue=""/>
                <f:selectItems value="#{formMetadataMgmtBean.formMetadataList}" var="f" itemLabel="#{f.formLabel}" itemValue="#{f.id}"/>
            </h:selectOneMenu>
            <h:message for="formFieldReferTo" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldOptions}"
                           for="formFieldOptions" />
            <h:inputText id="formFieldOptions" value="#{formMetadataMgmtBean.newField.optionValues}" size="100" />
            <h:message for="formFieldOptions" style="color:red;" />

            <h:outputLabel value="#{i18n.form_fieldDefaultValue}"
                           for="formFieldDefaultValue" />
            <h:inputText id="formFieldDefaultValue" value="#{formMetadataMgmtBean.newField.defaultValue}" size="100" />
            <h:message for="formFieldDefaultValue" style="color:red;" />

        </h:panelGrid>

        <h:commandButton id="saveFormFieldButton" value="#{i18n.save}"
                         action="#{formMetadataMgmtBean.saveField}">
            <f:ajax render="formFieldMetadataList newFieldDialog"
                    execute="newFieldName newFieldLabel newFieldType displayPositionRow displayPositionColumn
							displayPositionGroup formFieldInputColumns formFieldInputRows formFieldIsRequired
							formFieldExpression formFieldReferTo formFieldIsPrintable formFieldOptions
							formFieldDefaultValue formFieldIsLabel" />
        </h:commandButton>
        <h:message for="saveFormFieldButton" style="color:red;" />
    </ace:dialog>
</ui:fragment>